"""Exploitability-style evaluation helpers."""

from __future__ import annotations

from typing import Callable, Dict, Sequence


def evaluate_against_checkpoints(policy, opponent_pool: Sequence, eval_fn: Callable) -> Dict[str, float]:
    scores = {}
    for idx, opp in enumerate(opponent_pool):
        scores[f"opponent_{idx}"] = eval_fn(policy, opp)
    scores["mean_score"] = sum(scores.values()) / max(1, len(opponent_pool))
    return scores
